<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Deploying an Angular app on Azure - Backbase Engineering</title>
<meta name="description" content="Deploy a multi-locale Angular app using Azure Blob Storage and CDN Classic">


  <meta name="author" content="Yash Kapila">
  
  <meta property="article:author" content="Yash Kapila">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Backbase Engineering">
<meta property="og:title" content="Deploying an Angular app on Azure">
<meta property="og:url" content="https://backbase.github.io/2022/06/08/deploying-angular-app-on-azure">


  <meta property="og:description" content="Deploy a multi-locale Angular app using Azure Blob Storage and CDN Classic">



  <meta property="og:image" content="https://backbase.github.io/assets/images/post/angular-azure-banner.png">





  <meta property="article:published_time" content="2022-06-08T00:00:00+00:00">






<link rel="canonical" href="https://backbase.github.io/2022/06/08/deploying-angular-app-on-azure">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://backbase.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@300;700&display=swap" rel="stylesheet" data-optimized-fonts="true">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

  </head>

  <body class="layout--single min-vh-100 d-flex flex-column">
    <nav class="skip-links visually-hidden-focusable">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul class="list-group">
    <li class="list-group-item"><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li class="list-group-item"><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li class="list-group-item"><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<nav id="site-nav" class="navbar navbar-expand-lg navbar-dark">
  <div class="container">
    <div class="navbar-brand">
      
        <a class="site-logo text-decoration-none" href="/">
          <span class="bb-engineering-logo">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60.09 66.09">
    <g>
      <polygon
        points="9.49 20.83 18.98 20.83 18.98 11.34 18.98 1.85 9.49 1.85 0 1.85 0 11.34 9.49 11.34 9.49 20.83" />
      <path
        d="M38.98,32.76v-1.49c9.3-1.3,11.72-7.45,11.72-13.5,0-7.48-5.12-15.59-17.78-15.89h-7.61V11.34h7.61c6.69,.11,8.11,4.45,8,7.87-.23,7.66-3.67,7.88-9.59,8.05H9.49v37.96h22.69c15.26,0,20.38-8.65,20.38-17.68,0-7.72-2.7-13.39-13.58-14.79Zm-6.52,22.9h-13.31v-19.17h13.31c8.04,0,10.63,1.52,10.63,9.74,0,6.91-2.59,9.42-10.63,9.42Z" />
    </g>
  </svg>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="60.09 0 330.12 66.09" class="d-none d-lg-block">
    <g>
      <path
        d="M60.04,49.8c0-8.1,5.31-16.29,16.66-16.29,6.52,0,10.15,1.86,12.94,5.59v-12.1h-24.2v-8.38h33.51V55.85h5.59v9.31h-14.89v-4.65c-2.79,3.72-6.42,5.59-12.94,5.59-11.36,0-16.66-8.19-16.66-16.29Zm29.6,0c0-4.65-3.35-7.91-10.15-7.91s-10.15,3.26-10.15,7.91,3.35,7.91,10.15,7.91,10.15-3.26,10.15-7.91Z" />
      <path
        d="M108.72,41.89c0-14.61,7.17-24.2,20.85-24.2,12.19,0,19.36,7.54,19.36,18.62h-9.31c-.37-5.77-2.33-10.24-9.59-10.24-8.66,0-12.01,3.72-12.01,15.82s3.35,15.82,12.01,15.82c7.26,0,9.22-4.47,9.59-10.24h9.31c0,11.08-7.17,18.62-19.36,18.62-13.68,0-20.85-9.59-20.85-24.2Z" />
      <path
        d="M167.08,46.17v18.99h-9.31V0h9.31V37.79h7.26l13.03-19.18h11.26l-15.92,23.36,15.92,23.18h-11.26l-13.03-18.99h-7.26Z" />
      <path
        d="M249.18,41.89c0,13.68-5.31,24.2-20.39,24.2-6.52,0-11.08-2.51-13.87-6.52v5.59h-9.31V0h9.31V24.2c2.79-4,7.35-6.52,13.87-6.52,15.08,0,20.39,10.52,20.39,24.2Zm-9.31,0c0-11.17-3.35-15.82-12.47-15.82s-12.47,4.65-12.47,15.82,3.35,15.82,12.47,15.82,12.47-4.65,12.47-15.82Z" />
      <path
        d="M255.24,49.8c0-8.1,5.31-16.29,16.66-16.29,6.52,0,10.15,1.86,12.94,5.59v-12.1h-24.2v-8.38h33.51V55.85h5.59v9.31h-14.89v-4.65c-2.79,3.72-6.42,5.59-12.94,5.59-11.36,0-16.66-8.19-16.66-16.29Zm29.6,0c0-4.65-3.35-7.91-10.15-7.91s-10.15,3.26-10.15,7.91,3.35,7.91,10.15,7.91,10.15-3.26,10.15-7.91Z" />
      <path
        d="M306.71,60.13v-9.4c8.47,5.31,12.85,6.98,19.73,6.98,6.05,0,8.19-2.61,8.19-5.49,0-3.26-2.42-5.03-10.98-6.89-13.31-2.89-16.94-7.26-16.94-14.61,0-7.73,6.61-13.03,16.57-13.03,6.24,0,12.38,1.68,16.94,4.84v8.38c-6.8-3.35-12.75-4.84-17.87-4.84-4.75,0-6.33,2.05-6.33,4.37,0,2.61,1.21,4.37,9.12,6.52,13.78,3.72,18.8,6.61,18.8,15.17,0,7.91-6.61,13.96-17.5,13.96-7.26,0-12.94-1.4-19.73-5.96Z" />
      <path
        d="M350,41.89c0-14.61,5.77-24.2,20.11-24.2s20.11,8.66,20.11,23.27v5.12h-30.72c.65,6.52,3.26,11.64,14.15,11.64,3.72,0,7.35,0,13.4-1.68v8.19c-7.26,1.86-9.87,1.86-13.4,1.86-21.04,0-23.64-14.99-23.64-24.2Zm30.9-4.19c-.19-8.1-3.26-11.64-10.8-11.64s-10.33,4.1-10.8,11.64h21.6Z" />
    </g>
  </svg>
  <span class="visually-hidden">Backbase Engineering</span>
</span>

        </a>
      
    </div>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end me-4" id="navbarSupportedContent">
      <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="https://workatbackbase.com/" target="_blank">
                <span>Jobs</span>
              </a>
            </li>
          
            <li class="nav-item">
              <a class="nav-link" href="/about" >
                <span>About</span>
              </a>
            </li>
          </ul>
    </div>
        <ul class="navbar-nav" style="text-align:right;">
          <li class="nav-item">
            <a class="nav-primarylink" href="/principles"  style="text-decoration:none;">
              <span>Our Principles</span>
            </a>
          </li>
        </ul>
      
  </div>
</nav>


    <div class="initial-content">
      





<div id="main" role="main">
  <div class="container">
    <div class="row">
      <article class="page offset-md-2 col-md-8" itemscope itemtype="http://schema.org/CreativeWork">
        <meta itemprop="headline" content="Deploying an Angular app on Azure">
        <meta itemprop="description" content="Deploy a multi-locale Angular app using Azure Blob Storage and CDN Classic">
        <meta itemprop="datePublished" content="June 08, 2022">
        

        <div class="page__inner-wrap">
          
            <header>
              <h1 class="page__title" itemprop="headline">Deploying an Angular app on Azure
</h1>

              <aside class="author">
                
                  

<div itemscope itemtype="https://schema.org/Person">
  
    <div class="author__avatar">
      
        <img class="rounded-circle" src="/assets/images/avatars/yash.jpeg" alt="Yash Kapila" itemprop="image">
      
    </div>
  

  <div class="author__content text-muted">
    
      <h3 class="author__name" itemprop="name">Yash Kapila</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Principal Frontend Engineer - Expert Services</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <div class="author__urls social-icons">
      

      

      

      

      

      

    </div>
  </div>
</div>

                
                  

<div itemscope itemtype="https://schema.org/Person">
  
    <div class="author__avatar">
      
        <img class="rounded-circle" src="/assets/images/avatars/marco.jpeg" alt="Marco Santarelli" itemprop="image">
      
    </div>
  

  <div class="author__content text-muted">
    
      <h3 class="author__name" itemprop="name">Marco Santarelli</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Director of Frontend &amp; Mobile</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <div class="author__urls social-icons">
      

      

      

      

      

      

    </div>
  </div>
</div>

                
              </aside>

              
              

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <time datetime="2022-06-08T00:00:00+00:00">June 8, 2022</time>
      </span>
    

    

    
      
      

      <span class="page__meta-readtime small text-muted">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    

  </p>



              
            </header>
          

          <section class="page__content" itemprop="text">
            <p><img src="/assets/images/post/angular-azure-banner.png" alt="" /></p>

<h2 id="introduction">Introduction</h2>

<p>Backbase has been working towards a web architecture that follows <a href="https://jamstack.org">Jamstack</a> principles and aligns with Angular best practices. Our goal is to ensure our web app’s rendering strategy is decoupled from the backend and hosted on the best infrastructure possible.</p>

<p>As a first step in that direction, we replaced our Backbase proprietary app server (Portal) and moved to a lightweight <strong>Nginx</strong> web server. This brought several benefits:</p>

<ol>
  <li>Better performance: removing the server-side rendering ensured a low TTFB (Time To First Byte)</li>
  <li>Improved Security</li>
  <li>Cheaper infrastructure: we reduced our backend footprint and removed Portal and its dependent services</li>
  <li>Quick and easy deployments</li>
  <li>Scalability</li>
  <li>Greater consistency with Angular’s <a href="https://angular.io/guide/i18n-common-deploy">deployment suggestions</a></li>
</ol>

<p>Using Nginx allowed our customers to take this strategy regardless of whether they were on-premise or using a cloud vendor. However, we also want to enable our customers to deploy their apps to cloud components, so they can leverage the extra benefit of using the provider’s native components and save costs on CPU, memory, bandwidth, and computation time.</p>

<p>To explore how we could achieve this in our Angular applications, we created a demonstration application using Microsoft Azure’s web app services.</p>

<h2 id="leveraging-azure">Leveraging Azure</h2>

<p>Several Azure services can be used to serve and deploy static web applications:</p>

<ul>
  <li>Azure Blob Storage</li>
  <li>Azure CDN (Classic, Verizon, and Akamai)</li>
  <li>Azure Front Door</li>
  <li>Azure Web App</li>
  <li>Azure Static Web App</li>
</ul>

<p>Each service has its features and capabilities, so it’s essential to choose one that best fits an application’s needs and use case. For this demonstration, we decided to go with Azure Storage and CDN(classic).</p>

<p>Let’s take a quick look into these services.</p>

<h3 id="azure-blob-storage">Azure Blob Storage</h3>

<p>Azure Blob Storage is a fully managed object storage service provided by Microsoft as part of the Azure Cloud platform. It allows developers to store and retrieve large amounts of unstructured data, such as images, videos, and documents, in a highly scalable and cost-effective manner.</p>

<p>One of the main benefits of using Azure Blob Storage is its ability to scale to handle large amounts of data. The service automatically scales up and down based on usage and can store billions of objects in a single account. Additionally, Azure Blob Storage is also cost-effective, and you only pay for the storage and data transfer you use.</p>

<p>Some of the use cases this service is designed for are:</p>

<ul>
  <li>Delivering images or documents directly to a browser.</li>
  <li>Streaming video and audio.</li>
  <li>Storing files for distributed access.</li>
</ul>

<p>For more information on Azure Blob Storage, read <a href="https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction">Microsoft’s introduction</a> to the service.</p>

<h3 id="azure-cdn">Azure CDN</h3>

<p>A content delivery network (CDN) is a vast network of servers responsible for delivering content from an “origin” server to end users from a location closest to them, ensuring minimum latency. It achieves this by storing cached content on edge servers in point-of-presence (POP) locations that are geographically closest to the end users.</p>

<p>Azure CDN (Classic) is a CDN service provided by Microsoft as part of the Azure Cloud platform. It supports multiple protocols, including HTTP and HTTPS, and is integrated with Azure storage, allowing to serve content from the Azure storage account using CDN efficiently. Some benefits of using Azure Classic CDN to deliver web applications include the following:</p>

<ol>
  <li>Better performance and improved user experience due to the speed of delivery of content.</li>
  <li>Scaling to handle high instantaneous loads.</li>
  <li>Taking pressure off the origin by distributing cached content from the Edge servers.</li>
</ol>

<p>For more information on Azure CDN, read <a href="https://learn.microsoft.com/en-za/azure/cdn/cdn-overview">Microsoft’s introduction</a> to the service.</p>

<h4 id="front-door-alternative">Front Door (alternative)</h4>

<p>While we use Azure CDN for this demo application, Azure Front Door provides similar functionality. Front Door is Microsoft’s modern cloud Content Delivery Network (CDN) that provides a global, multi-cloud entry point for web apps. It offers features such as load balancing, built-in layer 3-4 DDoS protection, and the ability to define custom routing rules.</p>

<p>For more information on Front Door, read <a href="https://learn.microsoft.com/en-us/azure/frontdoor/front-door-overview">Microsoft’s introduction</a> to the service.</p>

<h4 id="azure-cdn-from-verizon--akamai-alternative">Azure CDN from Verizon &amp; Akamai (alternative)</h4>

<p>Azure CDN from Verizon &amp; Akamai is Microsoft’s latest Azure Content Delivery Network (CDN) service version. It’s a global service that allows the distribution of content to users worldwide by caching and delivering the content from a network of edge servers located in strategic locations.</p>

<p>Azure CDN from Verizon is based on the Verizon Media Platform, a CDN service provided by Verizon Communications. Azure CDN from Akamai is based on the Akamai Edge Platform, which Akamai Technologies provide.</p>

<p>It allows us to choose the provider that best fits our needs and use case and also allows us to use different providers for different endpoints, giving more flexibility and control over the CDN service.</p>

<h2 id="challenges">Challenges</h2>

<p>We identified a few challenges which needed to be resolved before our banking applications could be served and deployed using Storage and CDN:</p>

<ol>
  <li>Multi-locale support</li>
  <li>CSP</li>
  <li>Authentication (cookie vs header based)</li>
  <li>Security</li>
</ol>

<p>As part of this post, we will focus on addressing multi-locale support and CSP.</p>

<h2 id="angular--internationalization">Angular &amp; Internationalization</h2>

<p><strong>Internationalization</strong>, sometimes referred to as i18n, is the process of designing and preparing an application for use in different locales worldwide, and <strong>localization</strong> is the process of building versions of the project for different locales. The method of determining the appropriate language and cultural settings for a user based on their device or browser settings, geographic location, or user preferences is termed <strong>locale negotiation</strong>.</p>

<p>At Backbase, our customers have users across multiple regions, requiring their banking apps to be localised. Leveraging in-built Angular capabilities, we can achieve this quickly by building different versions of an app for each locale.</p>

<p>For example, an app having two languages Dutch(<code class="language-plaintext highlighter-rouge">nl</code>) and English(<code class="language-plaintext highlighter-rouge">en</code>) will have a final distribution like the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- dist
  - azure-angular-i18n
    - nl
      - index.html
      - favicon.ico
      - main.5f84b2e1a0ac5bcdcd0e.js
      - ....
    - en
      - index.html
      - favicon.ico
      - main.5f84b2e1a0ac5bcdcd0e.js
      - ....
</code></pre></div></div>

<p>While building and managing i18n tasks is covered well by Angular documentation, there is limited information regarding deploying a multi-locale app and locale negotiation. The <a href="https://angular.io/guide/i18n-common-deploy">Angular docs</a> only explain it for when using a web server like Nginx and Apache.</p>

<p>Web servers can perform a computation to determine the correct locale based on configured requirements. However, this implementation isn’t as straightforward with a storage service and CDN, as neither provides any built-in computation capability.</p>

<p>To overcome this challenge, we used a feature in Azure CDN known as <strong>Rule Engine</strong>. Rule Engine allows defining of custom rules and actions that can be applied to requests and responses as the CDN processes them.</p>

<p>The rules can be applied based on various conditions, such as URLs, headers, query parameters, and cookies. They are associated with an action that can be taken on the request or response, such as caching, redirecting, rewriting, or adding headers. Find more information about it in <a href="https://learn.microsoft.com/en-us/azure/frontdoor/front-door-rules-engine?pivots=front-door-standard-premium">the Microsoft Azure docs</a>.</p>

<p>Some examples of things we can do with Rule Engine in Azure CDN are as follows:</p>

<ul>
  <li>Serve a specific version of a file depending on the Accept-Language header.</li>
  <li>Add security headers to improve the security of content.</li>
  <li>Redirect users to a different URL based on the user’s country or device type.</li>
  <li>Cache different versions of an asset based on the user’s device or browser.</li>
  <li>Set custom headers or override existing headers.</li>
</ul>

<h3 id="demo-application">Demo Application</h3>

<p>The source code for our demonstration application is available <a href="https://github.com/Backbase/azure-angular-i18n">here</a>, and the live application is available <a href="https://angular-i18n-demo.azureedge.net">here</a>.</p>

<p><strong>Disclaimer: This post is only for demonstration purposes and shouldn’t be treated as production ready as it deals with basic locale negotiation requirements and lacks mandatory security aspects</strong></p>

<h4 id="prerequisites">Prerequisites</h4>

<ol>
  <li><a href="https://azure.microsoft.com/en-us/free/">Microsoft Azure account, free tier</a></li>
  <li><a href="(https://docs.microsoft.com/en-us/cli/azure/install-azure-cli)">Azure CLI</a></li>
  <li><a href="https://angular.io/guide/setup-local">Angular app</a></li>
</ol>

<h4 id="project-setup">Project Setup</h4>

<p>Following Angular <a href="https://angular.io/guide/i18n-common-overview">documentation</a>, the application is prepared for two languages, <code class="language-plaintext highlighter-rouge">en</code> and <code class="language-plaintext highlighter-rouge">nl</code>.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"projects"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"azure-angular-project"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"prefix"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"i18n"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"sourceLocale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"locales"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"nl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/locale/messages.nl.json"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"architect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"build"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"localize"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The app retrieves dummy information from an API made available through an <a href="https://swapi-function-app.azurewebsites.net">Azure function</a>. The function serves two APIs: <code class="language-plaintext highlighter-rouge">/planets</code>, which gives a dummy list of Star Wars planets and <code class="language-plaintext highlighter-rouge">/planets/{planetId}</code>, which returns dummy information about the selected planet.</p>

<h4 id="prepare-angular-distribution-package">Prepare Angular distribution package</h4>

<p>Angular generates a separate distribution package for each locale.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm run build
</code></pre></div></div>

<h4 id="create-azure-resources">Create Azure Resources</h4>

<p>We provision the required resources using Azure’s ARM templates (infrastructure-as-code) and AZ CLI. AZ CLI must have a default subscription set to provision resources.</p>

<p><strong>Resource Group</strong></p>

<p>A resource group is a container that holds all related resources for an Azure solution. All services provisioned for this demonstration application will be held inside the same resource group. We provision a resource group named <code class="language-plaintext highlighter-rouge">azure-angular-i18n</code> in the <code class="language-plaintext highlighter-rouge">West Europe</code> region.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az group create <span class="nt">--location</span> westeurope <span class="nt">--name</span> azure-angular-i18n
</code></pre></div></div>

<p><strong>Storage Account</strong></p>

<p>Using the <a href="https://github.com/Backbase/azure-angular-i18n/tree/master/azure_arm_templates/storage-account">ARM template</a>, we provision a storage account that will store the Angular builds named <code class="language-plaintext highlighter-rouge">angulardemoapps</code> and create two containers <code class="language-plaintext highlighter-rouge">en-locale</code> and <code class="language-plaintext highlighter-rouge">nl-locale</code> within it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az deployment group create <span class="nt">--resource-group</span> azure-angular-i18n <span class="nt">--template-file</span> azure_arm_templates/storage-account/template.json
</code></pre></div></div>

<p>Next, we upload the <code class="language-plaintext highlighter-rouge">en</code> and <code class="language-plaintext highlighter-rouge">nl</code> Angular distribution builds to their respective containers.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># --account-name is the name of the storage account, and -d is the container name</span>

az storage blob upload-batch <span class="nt">--account-name</span> angulardemoapps <span class="nt">-d</span> nl-locale <span class="nt">-s</span> dist/azure-angular-i18n/nl/ <span class="nt">--overwrite</span>

az storage blob upload-batch <span class="nt">--account-name</span> angulardemoapps <span class="nt">-d</span> en-locale <span class="nt">-s</span> dist/azure-angular-i18n/en/ <span class="nt">--overwrite</span>
</code></pre></div></div>

<p><strong>Important:</strong> We set the <code class="language-plaintext highlighter-rouge">cache-control</code> property for both locale’s <code class="language-plaintext highlighter-rouge">index.html</code> to <code class="language-plaintext highlighter-rouge">no-store</code> as we don’t want the CDN to cache it once it is provisioned. Caching the file causes issues with locale negotiation, especially when determining the right locale based on an empty context root <code class="language-plaintext highlighter-rouge">/</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az storage blob update <span class="nt">--account-name</span> angulardemoapps <span class="nt">--container-name</span> nl-locale <span class="nt">--name</span> index.html <span class="nt">--content-cache</span> <span class="s2">"no-store"</span>

az storage blob update <span class="nt">--account-name</span> angulardemoapps <span class="nt">--container-name</span> en-locale <span class="nt">--name</span> index.html <span class="nt">--content-cache</span> <span class="s2">"no-store"</span>
</code></pre></div></div>

<p><strong>CDN</strong></p>

<p>Once the storage account is setup, we provision a CDN using its <a href="https://github.com/Backbase/azure-angular-i18n/tree/master/azure_arm_templates/cdn">ARM template</a>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az deployment group create <span class="nt">--resource-group</span> azure-angular-i18n <span class="nt">--template-file</span> azure_arm_templates/cdn/template.json
</code></pre></div></div>

<p>The ARM template contains the following configurations:</p>

<ol>
  <li>Specifies the <strong>origin</strong> where the original resources reside and are fetched by the CDN when a cache doesn’t exist</li>
  <li>Specifies the rules for the Rule Engine for locale negotiation. These rules are as follows:
    <ul>
      <li>If the context root of the application is empty (<code class="language-plaintext highlighter-rouge">/</code>), check for a cookie named <code class="language-plaintext highlighter-rouge">locale</code>. If the value is <code class="language-plaintext highlighter-rouge">en</code>, return <code class="language-plaintext highlighter-rouge">en/index.html</code>. If the value is <code class="language-plaintext highlighter-rouge">nl</code>, return <code class="language-plaintext highlighter-rouge">nl/index.html</code>.</li>
      <li>For deep linking, if the URL path begins with <code class="language-plaintext highlighter-rouge">/en</code>, return <code class="language-plaintext highlighter-rouge">/en/index.html</code>. Otherwise, return <code class="language-plaintext highlighter-rouge">nl/index.html</code>.</li>
      <li>For all assets like CSS, JS &amp; SVGs, return them from their respective <code class="language-plaintext highlighter-rouge">en</code> or <code class="language-plaintext highlighter-rouge">nl</code> containers.</li>
      <li>As a fallback, if locale negotiation using cookies or URL path isn’t successful, return <code class="language-plaintext highlighter-rouge">en/index.html</code>.</li>
    </ul>
  </li>
  <li>Modifies the response header for <code class="language-plaintext highlighter-rouge">index.html</code> and adds a dummy Content-Security-Policy-Report-Only header.</li>
</ol>

<h2 id="final-thoughts">Final Thoughts</h2>

<p>The post gives an idea of how Azure native components are used to deploy an Angular application. We can further optimise Azure CDN (Classic) and Blob Storage implementation for a real application.</p>

<p>Additionally, an exciting new feature is coming up on Azure known as <a href="https://azure.microsoft.com/en-us/resources/cloud-computing-dictionary/what-is-edge-computing/">Edge Compute</a>. Edge Compute will make it possible to provide computation capabilities on Edge Locations and so achieve a lot more than the Rule Engine. Since the feature is still new, it isn’t available across all regions, but it is only a matter of time before it’s natively integrated with Azure’s CDN solutions.</p>

            
          </section>

          <footer class="page__meta">
            
            


          </footer>

          <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Deploying+an+Angular+app+on+Azure%20https%3A%2F%2Fbackbase.github.io%2F2022%2F06%2F08%2Fdeploying-angular-app-on-azure" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbackbase.github.io%2F2022%2F06%2F08%2Fdeploying-angular-app-on-azure" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fbackbase.github.io%2F2022%2F06%2F08%2Fdeploying-angular-app-on-azure" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

        </div>

        
      </article>
    </div>

    
    
      <div class="page__related col-md-8 offset-md-2">
        
        <div class="grid__wrapper row">
          
            



<div class="grid__item col-12 col-md-6 mb-4">
  <article class="archive__item card" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser ">
        <img src="/assets/images/post/angular_microfrontends.png" alt="Micro Frontends" class="rounded-top">
      </div>
    
    <div class="card-body d-flex flex-column">
      <h2 class="archive__item-title no_toc">
        
          <a class="text-decoration-none" href="/2023/12/13/setup-microfrontend" rel="permalink">Angular &amp; Micro Frontends
</a>
        
      </h2>
      

  <p class="page__meta">
    
      
      <span class="page__meta-readtime small text-muted">
      By
      
        Harsh Julka
      
      </span>
      
    

    

    
      
      

      <span class="page__meta-readtime small text-muted">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    

  </p>


      <p class="archive__item-excerpt" itemprop="description">Micro Frontends is a modern architectural approach for developing web applications.
</p>
      <div class="d-flex mt-auto justify-content-end">
        <a href="/2023/12/13/setup-microfrontend" rel="permalink" class="btn btn-sm btn-link stretched-link">Read more</a>
      </div>
    </div>
  </article>
</div>

          
            



<div class="grid__item col-12 col-md-6 mb-4">
  <article class="archive__item card" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser ">
        <img src="/assets/images/post/azure-banner.png" alt="System Engineering" class="rounded-top">
      </div>
    
    <div class="card-body d-flex flex-column">
      <h2 class="archive__item-title no_toc">
        
          <a class="text-decoration-none" href="/2023/11/21/a-new-chapter-exploring-azure-resources" rel="permalink">A New Chapter: Exploring Azure Resources
</a>
        
      </h2>
      

  <p class="page__meta">
    
      
      <span class="page__meta-readtime small text-muted">
      By
      
        Sri Balaji, 
      
        Ashish Arora
      
      </span>
      
    

    

    
      
      

      <span class="page__meta-readtime small text-muted">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    

  </p>


      <p class="archive__item-excerpt" itemprop="description">Azure’s limitless potential sets the stage for a promising journey, where opportunities abound on the horizon.
</p>
      <div class="d-flex mt-auto justify-content-end">
        <a href="/2023/11/21/a-new-chapter-exploring-azure-resources" rel="permalink" class="btn btn-sm btn-link stretched-link">Read more</a>
      </div>
    </div>
  </article>
</div>

          
            



<div class="grid__item col-12 col-md-6 mb-4">
  <article class="archive__item card" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser ">
        <img src="/assets/images/post/visual-testing-banner.png" alt="Quality Assistance Approach" class="rounded-top">
      </div>
    
    <div class="card-body d-flex flex-column">
      <h2 class="archive__item-title no_toc">
        
          <a class="text-decoration-none" href="/2023/11/03/visual-testing-using-playwright" rel="permalink">Visual Testing using Playwright
</a>
        
      </h2>
      

  <p class="page__meta">
    
      
      <span class="page__meta-readtime small text-muted">
      By
      
        Venkata Ravi Majjari
      
      </span>
      
    

    

    
      
      

      <span class="page__meta-readtime small text-muted">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    

  </p>


      <p class="archive__item-excerpt" itemprop="description">Visual testing helps to find issues that are important for end-users that cannot be caught by other types of testing
</p>
      <div class="d-flex mt-auto justify-content-end">
        <a href="/2023/11/03/visual-testing-using-playwright" rel="permalink" class="btn btn-sm btn-link stretched-link">Read more</a>
      </div>
    </div>
  </article>
</div>

          
        </div>
      </div>
    
  </div>
</div>

    </div>

    

    <div id="footer" class="mt-auto page__footer">
      <footer class="bg-primary text-white text-center py-5 small">
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <div class="footer-brand">
    
      <a class="site-logo text-decoration-none" href="/">
        <span class="bb-engineering-logo">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60.09 66.09">
    <g>
      <polygon
        points="9.49 20.83 18.98 20.83 18.98 11.34 18.98 1.85 9.49 1.85 0 1.85 0 11.34 9.49 11.34 9.49 20.83" />
      <path
        d="M38.98,32.76v-1.49c9.3-1.3,11.72-7.45,11.72-13.5,0-7.48-5.12-15.59-17.78-15.89h-7.61V11.34h7.61c6.69,.11,8.11,4.45,8,7.87-.23,7.66-3.67,7.88-9.59,8.05H9.49v37.96h22.69c15.26,0,20.38-8.65,20.38-17.68,0-7.72-2.7-13.39-13.58-14.79Zm-6.52,22.9h-13.31v-19.17h13.31c8.04,0,10.63,1.52,10.63,9.74,0,6.91-2.59,9.42-10.63,9.42Z" />
    </g>
  </svg>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="60.09 0 330.12 66.09" class="d-none d-lg-block">
    <g>
      <path
        d="M60.04,49.8c0-8.1,5.31-16.29,16.66-16.29,6.52,0,10.15,1.86,12.94,5.59v-12.1h-24.2v-8.38h33.51V55.85h5.59v9.31h-14.89v-4.65c-2.79,3.72-6.42,5.59-12.94,5.59-11.36,0-16.66-8.19-16.66-16.29Zm29.6,0c0-4.65-3.35-7.91-10.15-7.91s-10.15,3.26-10.15,7.91,3.35,7.91,10.15,7.91,10.15-3.26,10.15-7.91Z" />
      <path
        d="M108.72,41.89c0-14.61,7.17-24.2,20.85-24.2,12.19,0,19.36,7.54,19.36,18.62h-9.31c-.37-5.77-2.33-10.24-9.59-10.24-8.66,0-12.01,3.72-12.01,15.82s3.35,15.82,12.01,15.82c7.26,0,9.22-4.47,9.59-10.24h9.31c0,11.08-7.17,18.62-19.36,18.62-13.68,0-20.85-9.59-20.85-24.2Z" />
      <path
        d="M167.08,46.17v18.99h-9.31V0h9.31V37.79h7.26l13.03-19.18h11.26l-15.92,23.36,15.92,23.18h-11.26l-13.03-18.99h-7.26Z" />
      <path
        d="M249.18,41.89c0,13.68-5.31,24.2-20.39,24.2-6.52,0-11.08-2.51-13.87-6.52v5.59h-9.31V0h9.31V24.2c2.79-4,7.35-6.52,13.87-6.52,15.08,0,20.39,10.52,20.39,24.2Zm-9.31,0c0-11.17-3.35-15.82-12.47-15.82s-12.47,4.65-12.47,15.82,3.35,15.82,12.47,15.82,12.47-4.65,12.47-15.82Z" />
      <path
        d="M255.24,49.8c0-8.1,5.31-16.29,16.66-16.29,6.52,0,10.15,1.86,12.94,5.59v-12.1h-24.2v-8.38h33.51V55.85h5.59v9.31h-14.89v-4.65c-2.79,3.72-6.42,5.59-12.94,5.59-11.36,0-16.66-8.19-16.66-16.29Zm29.6,0c0-4.65-3.35-7.91-10.15-7.91s-10.15,3.26-10.15,7.91,3.35,7.91,10.15,7.91,10.15-3.26,10.15-7.91Z" />
      <path
        d="M306.71,60.13v-9.4c8.47,5.31,12.85,6.98,19.73,6.98,6.05,0,8.19-2.61,8.19-5.49,0-3.26-2.42-5.03-10.98-6.89-13.31-2.89-16.94-7.26-16.94-14.61,0-7.73,6.61-13.03,16.57-13.03,6.24,0,12.38,1.68,16.94,4.84v8.38c-6.8-3.35-12.75-4.84-17.87-4.84-4.75,0-6.33,2.05-6.33,4.37,0,2.61,1.21,4.37,9.12,6.52,13.78,3.72,18.8,6.61,18.8,15.17,0,7.91-6.61,13.96-17.5,13.96-7.26,0-12.94-1.4-19.73-5.96Z" />
      <path
        d="M350,41.89c0-14.61,5.77-24.2,20.11-24.2s20.11,8.66,20.11,23.27v5.12h-30.72c.65,6.52,3.26,11.64,14.15,11.64,3.72,0,7.35,0,13.4-1.68v8.19c-7.26,1.86-9.87,1.86-13.4,1.86-21.04,0-23.64-14.99-23.64-24.2Zm30.9-4.19c-.19-8.1-3.26-11.64-10.8-11.64s-10.33,4.1-10.8,11.64h21.6Z" />
    </g>
  </svg>
  <span class="visually-hidden">Backbase Engineering</span>
</span>

      </a>
    
  </div>
  <ul class="social-icons list-unstyled">
    

    
      
        
          <li><a href="https://www.youtube.com/user/Backbase" rel="nofollow noopener noreferrer" target="_blank"><i class="fab fa-youtube" aria-hidden="true"></i><span class="visually-hidden">YouTube</span></a></li>
        
      
        
          <li><a href="https://www.linkedin.com/company/backbase/" rel="nofollow noopener noreferrer" target="_blank"><i class="fab fa-linkedin-in" aria-hidden="true"></i><span class="visually-hidden">LinkedIn</span></a></li>
        
      
        
          <li><a href="https://www.instagram.com/backbase_global/" rel="nofollow noopener noreferrer" target="_blank"><i class="fab fa-instagram" aria-hidden="true"></i><span class="visually-hidden">Instagram</span></a></li>
        
      
        
          <li><a href="https://www.glassdoor.nl/Overzicht/Werken-bij-Backbase-EI_IE117266.11,19.htm?countryRedirect=true" rel="nofollow noopener noreferrer" target="_blank"><i class="fab custom-glassdoor" aria-hidden="true"></i><span class="visually-hidden">Glassdoor</span></a></li>
        
      
        
          <li><a href="https://www.facebook.com/backbase" rel="nofollow noopener noreferrer" target="_blank"><i class="fab fa-facebook-f" aria-hidden="true"></i><span class="visually-hidden">Facebook</span></a></li>
        
      
    

    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Backbase Engineering. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>


      </footer>
    </div>

    <script src='/assets/global-17ef4fa84e17b9a550efbf687d8fa54b.js' type='text/javascript'></script>


  </body>
</html>
